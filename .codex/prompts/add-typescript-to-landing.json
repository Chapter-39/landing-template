{
  "task": "Add TypeScript (vanilla) and build that outputs a single index.html",
  "instructions": [
    "Read the configuration file .codex.json in the project root and follow its rules.",
    "Create new branch codex/add-typescript-to-landing from current (369) branch.",
    "DO NOT modify existing business logic, branding, or repository metadata. Keep changes minimal.",
    "Install dev dependencies: typescript, esbuild.",
    "Create tsconfig.json targeting modern browsers (ES2020), module none, outDir dist, include src.",
    "Create src/main.ts with a minimal example (e.g., set document.title = 'Chapter 39' and render an H1 if missing).",
    "Add a build pipeline that produces a SINGLE HTML file:\n  - Use esbuild to bundle src/main.ts into dist/bundle.js (iife, minify).\n  - Generate dist/index.html from a tiny template that includes an inline <script> with the bundled JS (no external files).\n  - Implement a Node script scripts/inline-build.mjs that: (1) runs esbuild, (2) creates dist/index.html with a minimal semantic HTML (lang='en', charset, viewport, <h1>Chapter 39</h1>), (3) reads dist/bundle.js and inlines it inside <script></script>, (4) deletes dist/bundle.js so the only artifact is dist/index.html.",
    "Update package.json scripts without breaking existing ones:\n  - add \"build:ts\": \"node scripts/inline-build.mjs\"\n  - ensure \"build\" runs \"npm run build:ts\"\n  - do NOT remove current lint/format scripts.\n  - if a deploy script exists, make it publish the dist folder (single index.html).",
    "Create scripts/inline-build.mjs with robust error handling and clear console output. Exit non-zero on failure.",
    "Do NOT touch ESLint/Prettier configs unless strictly required. If needed, only add minimal TS parser settings.",
    "Add .gitignore entries for dist and temp build files if missing.",
    "Verify locally:\n  - Run npm run build and confirm dist/index.html is created and opens correctly with no external assets.\n  - Ensure index.html contains the inlined JS and the H1 'Chapter 39'.",
    "Commit only the necessary new/changed files (tsconfig.json, src/main.ts, scripts/inline-build.mjs, package.json, .gitignore, and minimal changes to deploy script if required).",
    "Push branch to origin as codex/add-typescript-to-landing.",
    "Output a short summary of changes and the exact commands to build and deploy."
  ]
}
